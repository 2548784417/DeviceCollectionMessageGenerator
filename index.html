
<!DOCTYPE html>
<html>
<head>

<!-- CSS -->
    <style>
        body {
            background-color: #121212; /* Dark background */
            color: #ffffff; /* Light text color */
            font-family: Arial, sans-serif;
            padding: 10px; /* Add some padding */
        }

        .formatted-text {
			white-space: pre-wrap; /* Maintains spaces and line breaks */
			line-height: 1.5; /* Adjust line height for better spacing */
			color: #ffffff; /* Light text color for formatted text */
		}

        #lockerBox, #staffBox {
			padding-top: 10px;
			padding-bottom: 10px;
		}

		label {
			color: #ffffff; /* Light color for labels */
			margin-right: 10px; /* Space between label and input */
			}

        select, input[type="checkbox"], input[type="number"],input[type="text"], textarea {
            background-color: #1e1e1e; /* Darker input background */
            color: #ffffff; /* Light text color for inputs */
            border: 1px solid #444; /* Lighter border for inputs */
            padding: 5px; /* Padding inside inputs */
            margin-bottom: 10px; /* Space between inputs */
            border-radius: 4px; /* Rounded corners for inputs */
        }
		
		/* Style email btn */
			.email-label {
			border: 1px solid #444; /* Border around checkbox section */
			margin-bottom: 10px; /* Space below checkbox section */
			margin-top: 10px;
			border-radius: 4px; /* Rounded corners for containers */
			display: flex;
			align-items: center;
			width: 100%;
			
		}
		
		

		#copyButton1 {
			
			margin: 5px;
		}


        /* Style for the borders */
			.border-container {
			border: 1px solid #444; /* Border around checkbox section */
			margin-bottom: 10px; /* Space below checkbox section */
			margin-top: 10px;
			border-radius: 4px; /* Rounded corners for containers */
			display: block; /* Change to block display */
			width: 100%;
			
		}

		
		/* Style for the location option border */
			.border-container-location {
			border: 1px solid red; /* Border around checkbox section */
			padding: 10px; /* Padding inside checkbox section */
			margin-bottom: 20px; /* Space below checkbox section */
			border-radius: 4px; /* Rounded corners for containers */
			display: block; /* Change to block display */
			width: 100%;
		}
	
			/*checkbox styles */
			
			input[type="checkbox"] {
			appearance: none; /* Remove default styling */
			width: 20px; /* Width of the checkbox */
			top: 3px; /* Adjust vertical alignment */
			height: 20px; /* Height of the checkbox */
			border: 2px solid #444; /* Border around the checkbox */
			border-radius: 50%; /* Rounded corners */
			outline: none; /* Remove outline */
			cursor: pointer; /* Pointer cursor on hover */
			transition: background-color 0.3s, border-color 0.3s; /* Smooth transition */
			margin-right: 5px; /* Space between checkbox and label */
			vertical-align: middle; /* Align with the text */
		}

		input[type="checkbox"]:checked {
			background-color: grey; /* Background color when checked */
			border: 4px solid white; /* Border around the checkbox */
			border-color: white; /* Border color when checked */
			position: relative; /* Position it relative to the checkbox */
			top: 3px; /* Adjust vertical alignment */
		}
		
		input[type="checkbox"]:not(:checked) {
			background-color: white; /* Background color when checked */
			border-color: grey; /* Border color when checked */
			position: relative; /* Position it relative to the checkbox */
			top: 3px; /* Adjust vertical alignment */
		}

		input[type="checkbox"]:checked::after {
			content: ''; /* Add a pseudo-element */
			display: block;
			position: relative; /* Position it relative to the checkbox */
			top: 3px; /* Adjust vertical alignment */
		}

        h1 {
            color: #ffffff; /* Light color for the heading */
			 margin-top: -20px; /* Adjust the value to move it up more */
        }

       /* horizontal checkboxes */
		.checkbox-container {
			display: flex; /* Use flexbox for layout */
			flex-wrap: wrap; /* Allow wrapping */
			gap: 2px; /* Space between checkboxes */
			align-items: center;
			
			
		}
		
		
		.sub-box-mini {
		background-color: #1e1e1e; /* Background color for the inner box */
		border: 1px solid #444; /* Border around the inner box */
		border-radius: 4px; /* Rounded corners */
		padding: 10px 5px; /* Padding inside the box */
		margin: 0 5px; /* Margin to create space between sub-boxes */
		display: flex; /* Use flexbox for layout */
		align-items: center; /* Center items vertically */
		width: 110px;
		height: 10px;
		display: none;
		}
		
		.sub-box-short {
		background-color: #1e1e1e; /* Background color for the inner box */
		border: 1px solid #444; /* Border around the inner box */
		border-radius: 4px; /* Rounded corners */
		padding: 10px 5px; /* Padding inside the box */
		margin: 0 5px; /* Margin to create space between sub-boxes */
		display: flex; /* Use flexbox for layout */
		align-items: center; /* Center items vertically */
		width: 20%;
		height: 15px;
		}
		
		.sub-box-long {
		background-color: #1e1e1e; /* Background color for the inner box */
		border: 1px solid #444; /* Border around the inner box */
		border-radius: 4px; /* Rounded corners */
		padding: 10px 5px; /* Padding inside the box */
		margin: 0 5px; /* Margin to create space between sub-boxes */
		display: flex; /* Use flexbox for layout */
		align-items: center; /* Center items vertically */
		width: 20%;
		display: flex;
		height: 15px;
		}
		
	
		
		/* Radio styles */
		
		/* Default radio button */
		input[type="radio"] {
			content: ''; 
			position: absolute; 
			left: 0; 
			top: 30%; 
			transform: translateY(-50%); 
			width: 20px; 
			height: 20px; 
			border: 2px solid #444; 
			border-radius: 50%; 
			background-color: grey; 
			transition: background-color 0.3s; 
			
		}
		
		

		/* Style for the label */
		label {
			position: relative; 
			padding-left: 30px; 
			cursor: pointer; 
			color: #ffffff; 
			margin-right: 20px; 
		}

		
		/* Checked state */
		input[type="radio"]:checked + label::before {
			background-color: white; 
			border-color: #6200ea; 
		}

		/* Inner circle for checked state */
		input[type="radio"]:checked + label::after {
			content: '';
			position: absolute;
			left: 6px; 
			top: 50%; 
			transform: translateY(-50%); 
			width: 8px; 
			height: 8px; 
			border-radius: 50%; 
			background-color: #6200ea; /* Inner circle color */
		}

		input[type="text"], input[type="number"] {
			width: 90%; /* Set a fixed width for inputs */
			padding: 5px; /* Adjust padding */
			margin: 0; /* Remove any default margin */
			margin-right: 10px; 
		}
		

		button {
			padding: 5px 10px; /* Add some padding to buttons */
			font-size: 14px; /* Adjust font size */
			margin: 0; /* Remove any default margin */
			
		}
		
		
		select {
			
			padding: 5px; /* Adjust padding to match label height */
			height: 30px; /* Set a fixed height for consistency */
			margin: 0; /* Remove default margin */
		}
		
		.alert {
			color: red;
			font-style: italic;
		}
		
		p {
			margin: 0; /* Remove default margin */
			padding: 0; /* Remove default padding */
			color: #ffffff; /* Keep text color consistent */
			}

		.button-spacing {
        margin-right: 140px; /* Adjust the value as needed */
		}
		
		.icon {
            font-size: 15px; /* Adjust icon size */
        }
		
		.disabled {
		cursor: not-allowed;
		opacity: 0.5; /* Optional: to visually indicate that the elements are disabled */	
		color: gray;
		
		
		}	
		
		.vertical-line1 {
        width: 2px; /* Line width */
        background-color: #ccc; /* Line color */
        height: 30px; /* Line height, adjust as needed */
        margin: 0 10px; /* Spacing around the line */
		}
		
		.vertical-line2 {
        width: 2px; /* Line width */
        background-color: #ccc; /* Line color */
        height: 20px; /* Line height, adjust as needed */
        margin: 0 10px; /* Spacing around the line */
		}
		
		/*if windows is half sized */
		@media (max-width: 930px) {
			.sub-box-short {
				padding: 5px; /* Adjust padding for smaller windows */
				flex: 1; /* Make buttons take equal space */
				display: flex;<!-- background-color: lightgray; /* Example change */ -->
				
			}
		}

		
		@media (min-width: 931px) {
			
		}
		
		/* menu styles */
		
		/* Style the tab */
		.tab {
		overflow: hidden;
		border: 1px solid #ccc;
		background-color: black;
		border-radius: 4px; /* Rounded corners */
		display: flex; /* Use flexbox to align items */
		width:101%;
		height:30px;
		text-align: center; /* Center the text in the buttons */
		
		}

		/* Style the buttons that are used to open the tab content */
		.tab button {
		background-color: inherit;
		border: none;
		outline: none;
		cursor: pointer;
		padding: 14px 16px;
		transition: 0.3s;
		color: white;
		flex: 1; /* Make buttons take equal space */
		text-align: center; /* Center the text in the buttons */
		/* Flexbox properties for centering text */
		display: flex;
		justify-content: center; /* Horizontally center the text */
		align-items: center;     /* Vertically center the text */
		
		}

		/* Change background color of buttons on hover */
		.tab button:hover {
		  background-color: #ddd;
		}
		

		/* Create an active/current tablink class */
		.tab button.active {
		  background-color: grey;
		}
		
		/* Hide all tab content by default */
		.tabcontent {
			display: none; /* Hide all tab content */
		}

		/* Optionally, you can add a style for when a tab is active */
		.tabcontent.active {
			display: block; /* Show the active tab content */
			
		}
		
		
		
		/* Hides the default up/down buttons */
		input[type="number"]::-webkit-inner-spin-button,
		input[type="number"]::-webkit-outer-spin-button {
			-webkit-appearance: none;
			
		}

		input[type="number"] {
			-moz-appearance: textfield; /* Firefox */
		}
		
		 

		 /* Style for the placeholder */
        textarea::placeholder {
            font-style: italic;
            color: #888; /* Optional: change color for better visibility */
        }
		
		 #bayNameOutput {
            width: 400px; /* Set desired width */
            height: 30px; /* Set fixed height */
            border: 1px solid #444; 
            padding: 5px; /* Adjust padding as needed */
            overflow: hidden; /* Prevent overflow */
            white-space: nowrap; /* Prevent line breaks */
            text-overflow: ellipsis; /* Show ellipsis for overflowed text */
            line-height: 30px; /* Match line height to height for vertical centering */
        }
		
		
		.button-float-right {
		margin-left:auto /* Floats the button to the right */
		}
		
		
		 .dropdown-content {
			display: none; /* Hide dropdown by default */
			position: absolute; /* Position it below the button */
			background-color: black; /* Background color */
			min-width: 175px; /* Set a minimum width */
			box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); /* Add shadow */
			z-index: 1; /* Ensure it appears above other content */
			top: 100%; /* Position directly below the button */
			right:0; /* change name to right */
			}
			
			

		.dropdown-content label {
			display: flex; /* Aligns radio button and text horizontally */
			align-items: center; /* Centers them vertically */
			color: white; /* Text color */
			padding: 15px; /* Padding for labels */
			cursor: pointer; /* Change cursor on hover */
			
			}

		.dropdown-content input {
			margin-right: 8px; /* Space between radio button and label text */
			transform: translateY(2px); /* Adjust this value to align the radio button */
			
			}
		
		.dropdown-content label span {
			margin-left: 20px; /* Adjust this value to increase spacing */
			}

		.dropdown-header {
			display: block;
			font-weight: bold; /* Make the header bold */
			padding: 8px; /* Add some padding */
			cursor: default; /* Change the cursor to indicate it’s unselectable */
			color: white; /* Change the color if desired */
			}
			
			#bayInput, #locationSelect {
			width: 100%; /* Make the select element take full width of the parent container */
			background-color: #2a2a2a; /* Optional: to match the container's background color */
			color: white; /* Text color for options */
			border: none; /* Optional: remove default border */
			padding: 5px; /* Optional: padding for the select box */
			font-size: 14px; /* Optional: adjust font size */
			border-radius: 4px; /* Match border-radius of the container */
		}
		
		<!-- #locationLabel{
		width:255px;
		padding: 0;
		} -->
		
		#locationSelect {
			font-size: 15.5px; /* Adjust the size as needed */
		}
		
		table {
            width: 100%;
            table-layout: fixed;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border: 1px solid #ddd;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        th {
            background-color: #000000;
        }
        /* Alternate row colors */
        tr:nth-child(odd) {
            background-color: #444444; /* Dark grey (black-ish) for odd rows */
            color: white; /* White text for better contrast */
        }
        tr:nth-child(even) {
            background-color: #222222; /* Lighter grey for even rows */
            color: white;
        }
		
		a {
    color: white; /* Set link color to white */
	text-decoration: none; /* Remove underline from links */
    
}

a:hover {
    color: #ddd; 
	
	font-weight: bold;
	text-decoration: underline;
}
 th:nth-child(n+2), td:nth-child(n+2) {
            text-align: center; /* Center all columns except for the first one (Name) */
        }
		
		/* Styling for the toast */
.toast {
  visibility: hidden;
  min-width: 250px;
  margin-left: -125px;
  background-color: #333;
  color: #fff;
  text-align: center;
  border-radius: 2px;
  padding: 16px;
  position: absolute;
  z-index: 1;
  left: 50%;
  bottom: 60px;
  font-size: 17px;
  transition: opacity 0.5s ease-in-out;
}

/* Visible toast with opacity */
.toast.show {
  visibility: visible;
  opacity: 1;
}
		
		
.programmatic-only {
  pointer-events: none; /* Prevent user clicks */
}

					
	
			

		
</style>
<!-- CSS end -->


<!-- icon reference -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">


<title>Techbar Template Generator</title>


<!-- Favicon -->

<link rel="icon" href="https://img.icons8.com/?size=100&id=50452&format=png&color=000000" type="image/svg+xml">
</head>


</head>
<!-- Main title -->
    <h1 id = "maintitle">RMIT Techbar Melbourne - Template Generator

	</h1>
	
	
<body>


<!-- Tabbed Menu - will auto resize to fit width by % -->
<div class="tab">
  <button class="tablinks active" onclick="openTab(event, 'deviceCollection')">Device Collection</button>
  <!-- <button class="tablinks" onclick="openTab(event, 'adobeForm')">Adobe Form</button> --> <!-- temp hide -->
  <button class="tablinks" onclick="openTab(event, 'forms')">Forms</button>
  <!-- add additional tabs here -->
</div>

<!-- Warning message -->
<br>
<p class ="alert"> Double check all outputs</p>
<!-- collection form start -->
<div id="deviceCollection" class="tabcontent">


<!-- location + locker or techbar box -->
<div class="border-container" id = "firstRow">
    <div class="checkbox-container">
		<!-- location box -->
		<div id = "locationBox" class= "sub-box-short"> 
<!-- 		<label id= "locationLabel">Techbar</label> -->
        <select id="locationSelect" onchange = "checkLocation()">
            <option value="" disabled selected>Techbar Location</option>
            <option value="80">80 - City</option>
            <option value="106">106 - City</option>
            <option value="94">94 - City</option>
            <option value="514">514 - Brunswick</option>
            <option value="202">202 - Bundoora</option>
        </select>
		</div>
		
		<!-- Vertical line -->
		<div class="vertical-line1"></div>
		
		<div id = "lockerBox" class= "sub-box-short"> 
		<!-- locker or techbar radios -->
        <label id = "lockerLabel">
            <input type="radio" id="locker" name="techbarOption" value="Device in Locker" onchange="updateLocation()">
            PC Locker
        </label>
		</div>
		
		<!-- Vertical line -->
		<div class="vertical-line1"></div>

		<div id = "staffBox" class= "sub-box-short"> 
        <label>
            <input type="radio" id="staff" name="techbarOption" value="See Techbar Staff" onchange="updateLocation()">
            Storeroom
        </label>
		</div>
	</div>
</div>	


   <!-- Additional Options box -->
    <div class="border-container" id = "secondRow">
        <div class="checkbox-container">
          
			
			
			
			
			<!-- <div id = "returnBox" class= "sub-box-short">
			<input type="checkbox" id="return" name="return" value="Return Device?">
			Return old device
			</div> -->
			
            
			<div id = "accessoryBox"class= "sub-box-short">
            <input type="checkbox" id="accessory" name="accessory" value="Accessory Only" onclick  = "updateOutput()">
            Accessory
			</div>
			
			<!-- Vertical line -->
			<div class="vertical-line1"></div> 
			
			<div id="followUpBox" class= "sub-box-short">
            <input type="checkbox" id="followup" name="followup" onclick = " resetBay(); disableBayandPin(); followUpOptions()";>		
			Follow up
			</div>
			
			
			
			<div id="followUpBoxCollection" class= "sub-box-mini">
			 <label>
				<input type="radio" id="followUpBtnCollection" name="followup" onclick = "followUpOptions();" onchange = "followUpBtnCollectionChange";>		
				Collection
			 <label>
			</div>
			
			<div id="followUpBoxDecom" class= "sub-box-mini">
			 <label>
				<input type="radio" id="followUpBtnDecom" name="followup" onclick = "updateOutput(); followUpOptions()";>		
				Decom
			 <label>
			</div>
			
			<div id="followUpBoxLoan" class= "sub-box-mini">
			<label>
				<input type="radio" id="followUpBtnLoan" name="followup"  onclick = "updateOutput(); followUpOptions()";>		
				Loan
			 <label>
			</div>
			
			
			<div style="position: relative; display: inline-block;">
			<div id="followUpDropdown" style="display: none;" class="dropdown-content">
				<span ></span>
				<label>
					<input type="radio" name="typeOption" onclick="updateOutput()" > <span>Collection</span>
				</label>
				<label>
					<input type="radio" name="typeOption" onclick="updateOutput()">  <span>Decom</span>
				</label>
				<label>
					<input type="radio" name="typeOption" onclick="updateOutput()">  <span>Loan</span>
				</label>
			</div>
			</div>
			
			<button type="button" id="collapseBtn" class="button-float-right" onclick = "collapse()" >
			<i class="fa-solid fa-down-left-and-up-right-to-center" title= "Collapse"></i>
			</button>
			 
        </div>
    </div>

<div class="hiddenrow" id="hiddenRow">
		<button type="button" id="expandBtn2" onclick = "expand()">
			<i class="fa-solid fa-maximize"  title= "Expand"></i>
		</button>
</div>

<!-- <div class="border-container" id="smallWindowRow">
		<div id="lockerFields"> 
    <div class="checkbox-container">
	</div>
	</div>
</div> -->
	
<div class="border-container" id= "thirdRow">

	<div id="lockerFields"> <!--third row start --> 
    <div class="checkbox-container">
	
		<div class="sub-box-short" id="bayBox" > 
            <!-- Bay  -->
            <!-- <input type="text" id="bayInput" placeholder="Bay number" oninput="updateOutput()" maxlength="2" /> -->
			<!-- <label for="bayInput" id = "bayLabel">Bay Number:</label> -->
			<select id="bayInput" onchange="updateOutput(); genFillPin();">
				<option value="" disabled selected>Bay Number</option>
				<option value="1">Bay 1</option>
				<option value="2">Bay 2</option>
				<option value="3">Bay 3</option>
				<option value="4">Bay 4</option>
				<option value="5">Bay 5</option>
				<option value="6">Bay 6</option>
				<option value="7">Bay 7</option>
				<option value="8">Bay 8</option>
				<option value="9">Bay 9</option>
				<option value="10">Bay 10</option>
				<option value="11">Bay 11</option>
				<option value="12">Bay 12</option>
				<option value="13">Bay 13</option>
				<option value="14">Bay 14</option>
				<option value="15">Bay 15</option>
			</select>
           
		</div>
		
		<!-- Vertical line -->
		<div class="vertical-line1"></div> 
		
		<div id = "pinBox" class="sub-box-short" > 
            <!-- PIN generate -->
            <input type="text" id="pinInput" readonly placeholder="Generate PIN →" onchange="updateOutput()" />
			<input type="hidden" id="actualPin" />
			<button id="hidePinBtn" onclick="pinVis()" disabled class="disabled">
				<i class="fa-regular fa-eye" title="Show PIN"></i>
			</button>

            <button id="pinGenBtn" onclick="genFillPin()">
			<i class="fa-solid fa-retweet" title="Generate 6 Digit PIN"></i>
			</button>
            <!-- Copy PIN button -->
            <button id="copyButton4" onclick="copyPin()" disabled class="disabled">
                <i class="fas fa-copy icon" title="Copy PIN to Clipboard" ></i> <!-- Copy icon -->
            </button>
			

		</div>
		
		
		
		<!-- Vertical line -->
		<div class="vertical-line1"></div>
		
		<div class="sub-box-short"> 
 
            <input type="text" id="nameInput" placeholder="Enter name here..." oninput="updateOutput()"/>
			
			<!-- name settings -->
			<div style="position: relative; display: inline-block;">
			<button type="button" id="nameSettings" onclick = "nameSettigs()">
				<i class="fa-solid fa-gears"></i>
			</button>
			
			<div id="nameDropdown" class="dropdown-content">
				<span class="dropdown-header">Include Name In</span>
				<label>
					<input type="radio" name="nameOption" onclick="updateOutput()" checked> <span>Pin only</span>
				</label>
				<label>
					<input type="radio" name="nameOption" onclick="updateOutput()">  <span>Collection only</span>
				</label>
				<label>
					<input type="radio" name="nameOption" onclick="updateOutput()">  <span>Both</span>
				</label>
				<label>
					 <input type="radio" name="nameOption" onclick="updateOutput()" value="None">  <span>None</span>
				</label>
			</div>
			
			
			</div>
		</div>
		
		<!-- Vertical line -->
		<div class="vertical-line1"></div>
		
		<!-- RITM -->
		<div id="ritmBox" class="sub-box-short"> 
 
            <input type="text" id="ritmInput" placeholder="RITM # (Optional)"/>
			<button type="button" id="copyBayOutput" onclick = "updateBayNameOutput()">
				<i class="fa-solid fa-file-export" title="Copy bay #, RITM, name and date(+5 days) for locker bay field"></i>
			</button>
			
	</div> 
		
		<!-- clear all BTN -->
        <button type="button" id="clearAllBtn" class="button-float-right" onclick = "resetBay(); resetPin(); resetName(); resetRITM();">
			<i class="fa-solid fa-rotate-right" title="Reset All"></i>
		</button>
		<button type="button" id="expandBtn" onclick = "expand()" >
			<i class="fa-solid fa-maximize"  title= "Expand"></i>
		</button>

	
		</div>

	</div>	
		<!-- opening hours fields -->
		<div id = "openingHoursBox"> 
			<div class= "sub-box-short"> 
				Input fields
				<input type="text" id="start1" placeholder="Open.." oninput="updateOutput()" maxlength="2" />
				<input type="text" id="end1" placeholder="Close..." oninput="updateOutput()" maxlength="2" />
				
				<input type="text" id="start2"  placeholder="Open.." oninput="updateOutput()" maxlength="2"/>
				<input type="text" id="end2" placeholder="Close..."oninput="updateOutput()" maxlength="2"/>

				</div>
		
		</div>
</div><!-- end third row -->


 <br>
		<div id = "bayOutputFields">
			<div class="email-label">
				<!-- copy -->
				<p id="bayEmailLabel">Bay Email</p><button id="copyButton1" onclick="copyToClipboard('outputCollection', 'copyButton1')">
				<i class="fas fa-copy icon"></i> </button>
			</div>
		</div>

		<!-- Output Field for Device collection text -->
		<div id="outputCollection" class="formatted-text" style="width: 100%; height: 220px; border: 1px solid #444; padding: 10px; overflow-y: auto;" contenteditable="false"></div>
		
		
		
		<div id = "pinOutputFields">
			<div class="border-container">
	
				<!-- Copy Pin email Btn -->
				<p>Pin Email <button id="copyButton2" onclick="copyToClipboard('outputPIN', 'copyButton2')">
				<i class="fas fa-copy icon"></i> 
				</button>
				
				<!-- email Pin BTn -->
				<button id="emailPin" onclick = "emailPin()">
					<i class="fa-solid fa-envelope" title="Email to user"></i>
				</button></p>
			</div>
		</div>
		<!-- Output Field for Pin email text -->
		<div id="outputPIN" class="formatted-text" style="width: 100%; height: 420px; border: 1px solid #444; padding: 10px; overflow-y: auto;" contenteditable="false"></div>
		
</div>
<!-- collection form end -->


<!-- adobe form start -->
<div id="adobeForm" class="tabcontent">
<br><br>
<div class="border-container">
<!-- Clear all/reset -->
<button type="button" id="adobeClearBtn">
	<i class="fa-solid fa-rotate-right" title="Clear All" onclick = "resetAdobeForm()"></i>
</button>
<br><br>
<input type="text" id="adobeNameInput" style = "width: 400px;" placeholder="Name"/>
<br><br>
<input type="text" id="adobeEmailInput" style = "width: 400px;" placeholder="Email"/>
<br><br>
<div>
<input type="text" id = "linkInput" value="https://rmititsm.service-now.com/sp?id=sc_cat_item&sys_id=a76e2d1887a3c290f8b455b97bbb350a" readonly style="width: 400px;">
<!-- Open button -->
<button id="openAdobeLink">
    <i class="fa-solid fa-arrow-up-right-from-square" onclick = "openAdobeLink()"title="Open Link"></i>
</button>
<!-- Copy button -->
<button id="copyAdobeForm" onclick = "copyAdobeLink()">
    <i class="fas fa-copy icon" title="Copy Email Template to Clipboard"></i>
</button>
</a>
<br><br>
<!-- email button -->
<button id="emailAdobe" onclick = "emailAdobe()"> Email
    <i class="fa-solid fa-envelope" title="Email to user"></i>
</button>
<button onclick="teamsAdobe()"> Teams          
	<i class="fa-solid fa-paper-plane" title="Send via MS Teams"></i>
</button>
</div>
</div>
</div>
<!-- adobe form end -->	



<div id="forms" class="tabcontent">
<br><br>
<div class="border-container">

<table border="1">
        <tr>
            <th style="width: 600px;">Name</th>
            <!-- <th style="width: 20px;">Copy</th>
			<th style="width: 20px;">Email</th>
			<th style="width: 20px;">Teams</th> -->
        </tr>
		
		<!-- adobe -->
        <tr>       
			<td><a href="https://rmititsm.service-now.com/sp?id=sc_cat_item&sys_id=a76e2d1887a3c290f8b455b97bbb350a" target="_blank">Adobe</a></td>
			<!-- <td></td>
			<td></td>
			<td></td> -->
        </tr>
		
		<!-- PW Reset -->
		<tr>
				<td><a href="https://sspr.rmit.edu.au/sspr/public/forgottenpassword" target="_blank">Password Reset</a></td>
				<!-- <td></td>
				<td></td>
				<td></td>   --> 
			</tr> 
		
		<!-- Elevated rights -->
        <tr>
			<td><a href="https://rmititsm.service-now.com/sp?id=sc_cat_item&sys_id=09bc9b90db3ae150d8257b53f39619c5" target="_blank">Elevated rights</a></td>
			<!-- <td></td>
			<td></td>
			<td></td> -->
        </tr>
		
		<!-- PAM account -->
        <tr>
			<td><a href="https://rmititsm.service-now.com/sp?id=sc_cat_item&sys_id=8d89abe0874ded502a71862c8bbb3566" target="_blank">PAM account</a></td>
			<!-- <td></td>
			<td></td>
			<td></td> -->
        </tr>
		
		<!-- Powershell access -->
        <tr>
			<td><a href="https://rmititsm.service-now.com/sp?id=sc_cat_item&sys_id=875b02f4873e65102a71862c8bbb3563" target="_blank">Powershell access</a></td>
			<!-- <td></td>
			<td></td>
			<td></td> -->
        </tr>
		
		<!-- Existing software request -->
        <tr>
			<td><a href="https://rmititsm.service-now.com/sp?id=sc_cat_item&sys_id=41b97ff5db726110d8257b53f39619d0" target="_blank">Existing software request</a></td>
			<!-- <td></td>
			<td></td>
			<td></td> -->
        </tr>
		
		<!-- Teaching Space software request -->
        <tr>
			<td><a href="https://rmititsm.service-now.com/sp?id=sc_cat_item&sys_id=053cb2fddb0ee70000b542a014961986" target="_blank">Teaching Space software request</a></td>
			<!-- <td></td>
			<td></td>
			<td></td> -->
        </tr>
		
		<!-- EU decom -->
        <tr>
			<td><a href="https://rmititsm.service-now.com/sp?id=sc_cat_item&sys_id=d0ea9b7f4ffa17002a4866a01310c7ec" target="_blank">End User Decom</a></td>
			<!-- <td></td>
			<td></td>
			<td></td> -->
        </tr>
		
		<tr>
				<td><a href="https://www.papercut.com/help/manuals/mobility-print/setting-up-a-device-mdns-dns/client-setup-windows/" target="_blank">Papercut Windows</a></td>   
		</tr>
			
		<tr>
				<td><a href="https://download.respondus.com/lockdown/download.php?ID=757253166" target="_blank">Respondus Lockdown Browser</a></td>  
		</tr> 
		
		<!-- new link template -->
        <!-- 
			<tr>
				<td><a href="link here" target="_blank">Name Here</a></td>  
			</tr> 
		-->
        
		
		
    </table>
	
</div>
</div> 



<!-- future tabs here 	 -->

<!-- generic tab format: -->
<!-- 
<div id="divnamehere" class="tabcontent">
<br><br>
<div class="border-container">
</div>
</div> 
-->


<script>
//GENERIC SCRIPTS
	
	
	
	// On load settings
   // Manually trigger the resize function when the page loads
window.onload = function() {
    const expandBtn = document.getElementById("expandBtn");
    if (expandBtn) expandBtn.style.display = "none";

    const hiddenRow = document.getElementById("hiddenRow");
    if (hiddenRow) hiddenRow.style.display = "none";

    document.getElementById("followup").checked = false;
    //document.getElementById("return").checked = true; // Automatically select "Return Device"
    document.getElementById("locker").checked = true;

    // Add event listeners
    document.getElementById('start1').addEventListener('input', updateLocation);
    document.getElementById('end1').addEventListener('input', updateLocation);
    document.getElementById('start2').addEventListener('input', updateLocation);
    document.getElementById('end2').addEventListener('input', updateLocation);

    // Call the title update function for the first load
    updateTitle(); // Ensure layout is updated

    // Hide the opening hours fields by default
    hideOpeningHours(); 

    // Manually trigger the resize event to apply layout based on current window size
    window.dispatchEvent(new Event('resize'));

	  
	
	
};

//listen to window changes
	window.addEventListener('DOMContentLoaded', () => {
    updateTitle(); // Run it once with current dimensions
		});

		// Run on window resize
		window.addEventListener('resize', () => {
			updateTitle();
		});
			


	
	//top menu
	 function openTab(evt, tabName) {
	  // Get all elements with class="tabcontent" and hide them
	  var i, tabcontent, tablinks;
	  tabcontent = document.getElementsByClassName("tabcontent");
	  for (i = 0; i < tabcontent.length; i++) {
		tabcontent[i].style.display = "none";  
	  }

	  // Get all elements with class="tablinks" and remove the "active" class
	  tablinks = document.getElementsByClassName("tablinks");
	  for (i = 0; i < tablinks.length; i++) {
		tablinks[i].classList.remove("active");
	  }

	  // Show the current tab, and add an "active" class to the button
	  document.getElementById(tabName).style.display = "block";
	  evt.currentTarget.classList.add("active");
	}

	// Ensure the "Device Collection" tab is open on load
	document.addEventListener("DOMContentLoaded", function() {
	  // Find the first tab (Device Collection) and trigger its click
	  document.querySelector(".tablinks").click();
	});


	
	//updates main title based on window size
	function updateTitle() 
	{
	
		const width = window.innerWidth;
		const titleElement = document.getElementById("maintitle");
		const alertElement = document.querySelector('.alert'); 
		const firstRow = document.getElementById('firstRow'); 
		const secondRow = document.getElementById('secondRow'); 
		const thirdRow = document.getElementById('thirdRow'); 
		
		const checkboxContainer = document.querySelector('.checkbox-container');
		//const localLabel = document.getElementById('locationLabel');
		const localDropbox= document.getElementById('locationSelect');
		
		const collapseBtn = document.getElementById('collapseBtn');
		const lockerLabel = document.getElementById('lockerLabel');
		const borderContainer = document.querySelector('.border-container');
		//const miniPinOutputFields = document.getElementById('miniPinOutputFields');
		const pinOutputFields = document.getElementById('pinOutputFields');
		const outputPinField = document.getElementById('outputPIN');
		const outputCollection = document.getElementById('outputCollection');
		const clearBtn = document.getElementById("clearAllBtn");
		const dropDown = document.getElementById('followUpDropdown');
		
		
		
		// Find the option with the value of "" (empty value, the default placeholder)
		const defaultOption = bayInput.querySelector('option[value=""]');
    
	
		 if (width <= 884) //if halfscreen
			{
				 if (width <= 800) //if super mini
					{
						

						//sizing
						firstRow.style.height = '20%';
						secondRow.style.height = '20%';
						thirdRow.style.height = '20%';
						
						document.body.style.padding = '1px';
						outputCollection.style.display = 'none';
						outputPinField.style.display = 'none';
						
						clearAllBtn.style.display = 'block';  // or 'inline-block' if you prefer
						clearAllBtn.style.marginLeft = '0';   // Ensure no margin on the left side
						clearAllBtn.style.float = 'none';     // Remove float
						
						
						
						//remove lines
						verticalLines.forEach(function(line)
						{
							line.remove(); 
						});
						
						

						// Resize and stack all checkbox containers vertically
						const checkboxContainers = document.querySelectorAll('.checkbox-container');
						checkboxContainers.forEach(function(checkboxContainer) 
						{
							checkboxContainer.style.flexDirection = 'column'; // Stack checkboxes vertically
							checkboxContainer.style.alignItems = 'flex-start'; // Align checkboxes to the left (or center)
				
						});
						
						// Resize and stack all sub-box-short containers vertically
						const subBoxShortContainers = document.querySelectorAll('.sub-box-short');
						subBoxShortContainers.forEach(function(subBoxShortContainer) {
							subBoxShortContainer.style.alignItems = 'center'; // Align items to the left (or center)
							subBoxShortContainer.style.width = '96%'; // Set width
							
						});
						
						// Change padding for all border containers
						const borderContainers = document.querySelectorAll('.border-container');
						borderContainers.forEach(function(borderContainer) {
							borderContainer.style.padding = '5px'; // Adjust padding for small screens
							
						});

						
						
						//text
						titleElement.textContent = ""; 
						titleElement.style.fontSize = '16px';
						alertElement.textContent = "Double Check Output";
						alertElement.style.fontSize = '11px';
						
						
						//location box
						//localLabel.style.display = "none";
						//localDropbox.style.width = '95%';
						
						//bay box
						bayInput.style.width = '95%';
						collapseBtn.style.display = 'none';
						bayInput.options[0].textContent = 'Bay #'; // Change text for the first option
		
					} 
					
				else //if halfscreen
					{
						titleElement.textContent = "RMIT Techbar Template Generator"; 
						titleElement.style.fontSize = '32px';
						alertElement.style.fontSize = '16px';
						firstRow.style.height = '20%';
						secondRow.style.height = '20%';
						thirdRow.style.height = '20%';
						
						outputCollection.style.display = 'block';
						outputPinField.style.display = 'block';
						
						
						clearAllBtn.style.display = '';  // Reset to original display property
						clearAllBtn.style.float = '';    // Remove custom inline float
						clearAllBtn.classList.add('button-float-right');  // Ensure class is applied
						
						
						//location box
						//localLabel.style.display = "block";
						//localLabel.style.paddingRight = "0px";
						localDropbox.style.width = '100%';
						
						 // Reset checkboxes to horizontal layout
						const checkboxContainers = document.querySelectorAll('.checkbox-container');
						checkboxContainers.forEach(function(checkboxContainer) 
						{
							checkboxContainer.style.flexDirection = 'row'; // Reset to horizontal layout
							checkboxContainer.style.alignItems = 'center'; // Align checkboxes to the center
							checkboxContainer.style.width = 'auto';
						});	
						
						collapseBtn.style.display = 'block';
						
						// Resize and stack all sub-box-short containers vertically
						const subBoxShortContainers = document.querySelectorAll('.sub-box-short');
						subBoxShortContainers.forEach(function(subBoxShortContainer) {
							subBoxShortContainer.style.width = '20%'; // Set width
						});
						
						
						
						//Text
						bayInput.options[0].textContent = 'Select Bay Number'; // Change text for the first option
						
						document.body.style.padding = '20px';
						
						
						
						
					}
			} 
		else if (width >= 885)//if fullscreen or normal
			{
				titleElement.textContent = "RMIT Techbar Template Generator"; 
				

				// Change padding for all border containers back to default
						const borderContainers = document.querySelectorAll('.border-container');
						borderContainers.forEach(function(borderContainer) {
							borderContainer.style.paddingTop = '5px'; // Default padding for larger screens
							borderContainer.style.paddingBottom = '5px'; // Default padding for larger screens
						});
			}
		
	}
	
	

	
	function copyToClipboard(divId, buttonId)
	{
		const div = document.getElementById(divId);
		const button = document.getElementById(buttonId);
		
		if (followUpBtn.checked)
		{
				
		}
		
			// Check the value of bayInput, lockerBtn status, and the button ID
		if (!followUpBtn.checked && bayInput.value === "" && lockerBtn.checked && button.id === "copyButton1") {
			// Change the button icon when conditions are met
			button.innerHTML = '<i class="fa-solid fa-triangle-exclamation"></i>'; // Change icon
			
			// Reset the button icon after 1.5 seconds
			setTimeout(() => {
				button.innerHTML = '<i class="fas fa-copy icon"></i>'; // Reset to copy icon
			}, 1500);
			
			// Change the border color of bayBox to red if the conditions are met
			const bayBox = document.getElementById('bayBox'); // Assuming bayBox is the element
			const originalBorder = bayBox.style.border; // Store the original border color
			
			// Change the border color to red
			bayBox.style.border = '2px solid red';

			// After 1 second, restore the original border color
			setTimeout(() => {
				bayBox.style.border = originalBorder; // Restore original border color
			}, 1500); // 1.5 seconds
		}
		
		else if (pinInput.value === "" && lockerBtn.checked && button.id === "copyButton2")
		{
			button.innerHTML = '<i class="fa-solid fa-triangle-exclamation"></i>'; // Change icon 
			
			// Reset the button icon after 3 seconds
			setTimeout(() => {
				button.innerHTML = '<i class="fas fa-copy icon"></i>'; // Reset to copy icon
			}, 1500);
			
			//change empty field (PIN number) red
			// Store the original border color
			const originalBorder = pinBox.style.border;

			// Change the border color to red
			pinBox.style.border = '2px solid red';

			// After 1 second, restore the original border color
			setTimeout(() => 
			{
				pinBox.style.border = originalBorder; // Restore original border color
			}, 1500); // 1 second
		}
		
		else
		{
			// Create a temporary textarea element to copy text
			const textarea = document.createElement('textarea');
			textarea.value = div.innerText; // Use innerText to get plain text
			textarea.style.position = 'fixed'; // Prevent scrolling to bottom of page
			document.body.appendChild(textarea);
			textarea.select(); // Select the textarea content

			// Copy the text to clipboard
			document.execCommand('copy');
			document.body.removeChild(textarea); // Remove the textarea

			
			button.innerHTML = '<i class="fas fa-check icon"></i>'; // Change icon to check mark

			// Reset the button icon after 3 seconds
			setTimeout(() => {
				button.innerHTML = '<i class="fas fa-copy icon"></i>'; // Reset to copy icon
			}, 3000);
		}
	}
	
	
	

//END GENERIC SCRIPTS
	
//COLLECTION SCRIPTS	
	//const returnCheckbox = document.getElementById("return");
	const accessoryCheckbox = document.getElementById("accessory");
	const locationBox = document.getElementById('locationBox');
	
	const lockerBtn = document.getElementById('locker');
	const lockerBox = document.getElementById('lockerBox');
		
	const staffBtn = document.getElementById('staff');
	const staffBox = document.getElementById('staffBox');
		
	const followUpBtn = document.getElementById('followup');
	const followUpBox = document.getElementById('followUpBox');
	
	const followUpBtnCollection = document.getElementById('followUpBtnCollection');
	const followUpBtnDecom = document.getElementById('followUpBtnDecom');
	const followUpBtnLoan = document.getElementById('followUpBtnLoan');
		
	const bayInput = document.getElementById('bayInput');
	//const returnBtn = document.getElementById('return');
	//const returnBox = document.getElementById('returnBox');
	const bayBox = document.getElementById('bayBox');
	const pinBox = document.getElementById('pinBox');
	const ritmBox = document.getElementById('ritmBox');
		
	const accessoryBtn = document.getElementById('accessory');
	const accessoryBox = document.getElementById('accessoryBox');
	
	
	//const openingHoursBox = document.getElementById('openingHoursBox');
	const firstRow = document.getElementById('firstRow');
	const secondRow = document.getElementById('secondRow');
	const thirdRow = document.getElementById('thirdRow');
	const pinOutputFields = document.getElementById('pinOutputFields');
	
	
	const emailPINBtn = document.getElementById('emailPin');
	const copyPinBtn = document.getElementById('copyButton2');
	const bayEmailLabel = document.getElementById('bayEmailLabel');	
	
	const copyCollectionBtn = document.getElementById('copyButton1');

	const pinInput = document.getElementById('pinInput');
	const pinHideBtn = document.getElementById('hidePinBtn');
	const pinGenBtn = document.getElementById('pinGenBtn');
	const pinCopyBtn = document.getElementById('copyButton4');
	
	
	const nameInput = document.getElementById('nameInput');
	const nameSettings = document.getElementById('nameSettings');

	const copyBayOutput = document.getElementById('copyBayOutput');
	const ritmInput = document.getElementById('ritmInput');
	const clearAllBtn = document.getElementById('clearAllBtn');
	const collapseBtn = document.getElementById('collapseBtn');
	

	
    var firstLine =  `Your computer is now ready to collect from RMIT Techbar @`;
	var secondLine = `\n\nYour device has been assigned to a PC Locker tower, you will receive a separate email from RMIT Device Collection with a Pin number. \n\nYour Bay number is: `;
	var thirdLine =  `\n\nYou will be required to collect your device during university operation hours within 5 business days.`;
	var fourthLine = ``;
	var finalLine = `\n\nIf you require any assistance with setting up your new device, please approach our staff at the Techbar who are available to help.`;
	const verticalLines = document.querySelectorAll('.vertical-line1');
	


	function allButtonsUsable(enable)
	{	
		const elements = [collapseBtn,copyCollectionBtn,emailPINBtn,copyPinBtn,clearAllBtn,copyBayOutput,nameSettings, ritmInput,nameInput,pinGenBtn,pinInput,bayInput,lockerBtn,lockerBox,staffBtn,staffBox,followUpBtn,followUpBox,accessoryBtn,accessoryBox];

		elements.forEach(element => {
			element.disabled = !enable; // Set disabled based on the enable parameter
			if (enable)
			{
				element.classList.remove("disabled"); // Remove disabled class when enabling
				element.title = ""; // Clear tooltip message when enabled
				locationBox.style.borderColor = "green"; //location box green
				lockerBox.style.borderColor = "green"; // Change box border color
				//returnBox.style.borderColor = "green"; // Change box border color
			} 
			else 
			{
				element.classList.add("disabled"); // Add disabled class when disabling
				element.title = "Please select Techbar location"; // Set tooltip message when disabled
				openingHoursBox.style.display = "none"; //hide opening hours
				locationBox.style.borderColor = "red"; //location box red
				
			}
		});
		
		
	}

	function checkLocation()
	{
		const locationDropdown = document.getElementById("locationSelect");
		const selectedLocation = locationDropdown.value; // Get the selected value

		// Check if a location is selected
		if (selectedLocation === "") 
			{

				// Disable all buttons
				allButtonsUsable(false);

				// Clear outputs
				document.getElementById("outputPIN").innerHTML = "";
				document.getElementById("outputCollection").innerHTML = "";		
			} 
		
		if (selectedLocation != "" && !staffBtn.disabled) 
		{
			updateOutput();
			
		}	
		
		else if (selectedLocation != "" && staffBtn.disabled) 
			{

			allButtonsUsable(true);
			updateOutput();
			
				
			} 	
		
	}
	
	
	function updateOutput()
	{
		
		const locationDropdown = document.getElementById("locationSelect");
		const selectedLocation = locationDropdown.value; // Get the selected value
		
		var name = document.getElementById('nameInput').value;
		const nameOptions =  document.getElementsByName("nameOption");
		let selectedValue = '';
		var pin = document.getElementById('actualPin').value;
		var outputNamePin = ``;
		var outputNameCollection = ``;
		var outputPINnumber = `${pin}`;
		var outputPIN = document.getElementById("outputPIN");
		var location = ``;
		var bayNumber = document.getElementById("bayInput").value;
		var outputBay = `${bayNumber}`;
		
		var start1 = document.getElementById('start1');
		var end1 = document.getElementById('end1');
		var start2 = document.getElementById('start2');
		var end2 = document.getElementById('end2');
		
		
		

		<!-- loop thru name options list to get selected -->
		for (const option of nameOptions) 
		{
			if (option.checked) 
			{
				selectedValue = option.nextElementSibling.textContent; // Get the label text
				break; // Exit the loop once the checked option is found
			}
		
		}

			
			<!-- Pin output updates -->
			if (selectedValue === 'Pin only')
			{
				outputNamePin = `Hi ${name} \n\n`;
				outputNameCollection = ``;
			} 
			else if (selectedValue === 'Collection only') 
			{
				outputNameCollection = `Hi ${name} \n\n`;
				outputNamePin = ``;
			} 
			else if (selectedValue === 'Both')
			{
				outputNamePin = `Hi ${name} \n\n`;
				outputNameCollection = `Hi ${name} \n\n`;
			} 
			else if (selectedValue === 'None') 
			{
				outputNamePin = ``;
				outputNameCollection = ``;	
			}
			
			<!-- location updates -->
			if(selectedLocation ==="80")
			{
					location = " Building 80, Level 3, Room 8.";
					
					// Set initial values (they will be set once when the location is selected)
					start1.value = "9";  // Initial value for start1
					end1.value = "5";    // Initial value for end1

					// Reset other fields
					start2.value = "";
					end2.value = "";
	
					// Disable unused fields (start2, end2)
					start2.classList.add("disabled");
					start2.disabled = true;
					end2.classList.add("disabled");
					end2.disabled = true;

					// If staff button is checked, update the second line with the opening hours
					if (staffBtn.checked) 
					{
						secondLine = `\n\nPlease see our Techbar staff at this location about your device collection. \n\nOur opening hours are ` + start1.value + `am - ` + end1.value + `pm, Monday - Friday (excluding public holidays).`;
					}
				
			}
			
			if(selectedLocation ==="106")
			{
				location = " Building 106, level 6.";
				
				// Set initial values (they will be set once when the location is selected)
					start1.value = "9";  // Initial value for start1
					end1.value = "6";    // Initial value for end1

					// Reset other fields
					start2.value = "";
					end2.value = "";
				
				
				//disable unused bays
				start2.classList.add("disabled");
				start2.disabled = true; 
				end2.classList.add("disabled");
				end2.disabled = true; 
				
				if (staffBtn.checked)
				{
					 secondLine = `\n\nPlease see our Techbar staff at this location about your device collection. \n\nOur opening hours are ` + start1.value + `am - ` + end1.value + `pm, Monday - Friday (excluding public holidays).`;
				}
			}
			
			if(selectedLocation ==="94")
			{
				location = " Building 94, Level 3, Room 203 (Carlton Library).";
				
				// Set initial values (they will be set once when the location is selected)
					start1.value = "9";  // Initial value for start1
					end1.value = "5";    // Initial value for end1

					// Reset other fields
					start2.value = "";
					end2.value = "";
				
				//enable bays
				start2.classList.remove("disabled");
				start2.disabled = false; 
				end2.classList.remove("disabled");
				end2.disabled = false; 
				
				if (staffBtn.checked)
				{
					  secondLine = `\n\nPlease see our Techbar staff at this location about your device collection. \n\nOur opening hours are ` + start1.value + `am - ` + end1.value + `pm, Monday - Friday (excluding public holidays).`;
				}
			}
			
			if(selectedLocation ==="514")
			{
				location = " Building 514, Level 1, Room 2A (Student Study area).";
				
				// Set initial values (they will be set once when the location is selected)
					start1.value = "9";  // Initial value for start1
					end1.value = "1";    // Initial value for end1

				// Reset other fields
					start2.value = "2";
					end2.value = "5";

				
				//enable bays
				start2.classList.remove("disabled");
				start2.disabled = false; 
				end2.classList.remove("disabled");
				end2.disabled = false; 
				
				if (staffBtn.checked)
				{
					 secondLine = `\n\nPlease see our Techbar staff at this location about your device collection. \n\nOur opening hours are ` + start1.value + `am - ` + end1.value + `pm / ` + start2.value + `pm - ` + end2.value +`pm, Monday - Friday (excluding public holidays).`;
				}
			}
			
			if(selectedLocation ==="202")
			{
				location = " Building 202, level 2, Room 5 (Student Connect area, near Desk 2).";
				
				// Set initial values (they will be set once when the location is selected)
					start1.value = "9";  // Initial value for start1
					end1.value = "12";    // Initial value for end1

					// Reset other fields
					start2.value = "1";
					end2.value = "5";
				
				//enable bays
				start2.classList.remove("disabled");
				start2.disabled = false; 
				end2.classList.remove("disabled");
				end2.disabled = false; 
				
				if (staffBtn.checked)
				{
					 secondLine = `\n\nPlease see our Techbar staff at this location about your device collection. \n\nOur opening hours are ` + start1.value + `am - ` + end1.value + `pm / ` + start2.value + `pm - ` + end2.value +`pm, Monday - Friday (excluding public holidays).`;
				}
			}
			 
			 // Update firstLine based on whether accessoryBtn or followUpBtn is checked
			
			
			
			
			// Update firstLine based on whether accessoryBtn or followUpBtn is checked
			<!-- if (returnBtn.checked)  -->
			<!-- { -->
				<!-- fourthLine = `\n\nIf you have an old computer, you will need to return it with the charger, please place it in the same locker bay as your new device, or hand it to the Techbar staff upon collection.`; -->
			<!-- } -->
			<!-- // Update firstLine based on whether accessoryBtn or followUpBtn is checked -->
			<!-- if (!returnBtn.checked)  -->
			<!-- { -->
				<!-- fourthLine = ``; -->
			<!-- } -->
			
			if (staffBtn.checked)
			{
				outputPIN = ``;
			}
			
			

			var outputCollection = document.getElementById('outputCollection');
			
			outputCollection.textContent = outputNameCollection + firstLine + location + secondLine + outputBay + thirdLine + fourthLine + finalLine;
			outputPIN.textContent = outputNamePin + `Your device has been assigned a locker in our PC Locker Tower and is ready for collection. \n\nThe PIN for your RMIT Device Collection is: \n\n` + outputPINnumber + `\n\nFor security reasons, you will receive a separate Email containing your Locker Bay Number.\n\nYou will be required to collect your device during university operation hours within 5 business days.\n\nIf you have any issues, please see TechBar staff during staffed hours.\n\nRegards,RMIT TechBar Team.\n\nPlease do not reply to this email as it is an unmonitored inbox.`;

	}

	//PIN scripts
	function genPin() 
	{
		pinHideBtn.disabled=false;
		pinHideBtn.classList.remove("disabled");
		
		buttonState("copyButton4", false);
		// Generate a random number between 0 and 999999
		const randomNum = Math.floor(Math.random() * 1000000);
		// Convert it to a string and pad to ensure it's always 6 digits
		const pin = String(randomNum).padStart(6, '0');
		return pin;
		updateOutput();
		
		buttonState("copyButton4", false);

		
	}

	// Function to generate and fill the PIN in the input field
	function genFillPin() 
	{
		// Generate a new PIN
		const pin = genPin();
		
		// Store the actual PIN in the hidden field
		document.getElementById('actualPin').value = pin;

		// Display the PIN with the last 3 digits masked (***)
		const maskedPin = pin.slice(0, 3) + '***';
		document.getElementById('pinInput').value = maskedPin;

	
		updateOutput();
	}
	 	
	function buttonState (btnId, btnOff)
	{
		const button = document.getElementById(btnId);

		if (button) 
		{
			if (btnOff)
			{
				// Disable the button and add the 'disabled' class
				button.disabled = true;
				button.classList.add("disabled");
			} 
			else
			{
				// Enable the button and remove the 'disabled' class
				button.disabled = false;
				button.classList.remove("disabled");
			}
		} 
			
	}
	function resetPin()
	{
		var pinInput = document.getElementById('pinInput');
		
            
            // Only reset if the pinInput field is not empty
            if (pinInput.value !== "") 
			{
                pinInput.value = "";
                updateOutput();
				buttonState("hidePinBtn",true);
				buttonState("copyButton4", true);
				
            }
	}
	
	function pinVis() 
	{
		const width = window.innerWidth;
		if (width <200)
						{
							document.getElementById("hidePinBtn").style.display = "none";
													setTimeout(() => {
								hidePinBtn.style.display = "block"; // You can use "inline-block" or "flex" depending on your layout
							}, 800);
						}
						else
						{	
							document.getElementById("hidePinBtn").style.display = "block";
						}
		var pinInput = document.getElementById("pinInput");
		var hidePinBtn = document.getElementById("hidePinBtn");
		var pinGenBtn = document.getElementById("pinGenBtn");
		var actualPin = document.getElementById("actualPin").value;
		var icon = hidePinBtn.querySelector("i"); // Get the <i> element inside the button
		

		if (pinInput !== null) {
			// Disable the button temporarily for 5 seconds
			hidePinBtn.disabled = true;
			hidePinBtn.classList.add("disabled");
			pinGenBtn.disabled = true;
			pinGenBtn.classList.add("disabled");
			

			// Toggle the input type between text and password
			if (icon.classList.contains("fa-eye")) {
				// Show the actual PIN
				pinInput.value = actualPin;
				icon.classList.remove("fa-eye");
				icon.classList.add("fa-clock");
			   
				
				// Revert the pin visibility back after 5 seconds
				setTimeout(function() {
					pinInput.value = actualPin.slice(0, 3) + '***';  // Mask the last 3 digits
					icon.classList.remove("fa-clock");
					icon.classList.add("fa-eye");
					
					
					// Enable the button again after 5 seconds
					hidePinBtn.disabled = false;
					hidePinBtn.classList.remove("disabled");
					pinGenBtn.disabled = false;
					pinGenBtn.classList.remove("disabled");
				}, 800); // 5000ms = 5 seconds
			} 
			else if (icon.classList.contains("fa-clock"))
			{
				// If it's already hidden, just show the masked PIN immediately
				pinInput.value = actualPin.slice(0, 3) + '***'; 
				icon.classList.remove("fa-clock");
				icon.classList.add("fa-eye");

				
				// Enable the button immediately
				hidePinBtn.disabled = false;
				hidePinBtn.classList.remove("disabled");
				pinGenBtn.disabled = false; 
				pinGenBtn.classList.remove("disabled");
			}
		}
	}

	
	
	//Bay scripts 
	function resetBay()
	{
		document.getElementById('bayInput').value = "";
	}
	
	function disableBayandPin()
	{
	    if (followUpBtn.checked)
		{
			resetPin();
	
			bayInput.disabled=true;
			bayInput.classList.add("disabled");
			
			pinGenBtn.disabled = true;
			pinGenBtn.classList.add("disabled");
			
			hidePinBtn.disabled = true;
			hidePinBtn.classList.add("disabled");
			
			ritmBox.disabled = true;
			ritmBox.classList.add("disabled");
			ritmInput.disabled = true;
			ritmInput.classList.add("disabled");
			
			copyBayOutput.disabled=true;
			copyBayOutput.classList.add("disabled");
			
			copyButton4.disabled=true;
			copyButton4.classList.add("disabled");
			
			pinInput.disabled=true;
			pinInput.classList.add("disabled");
			
		}
		else
		{
			
				bayInput.disabled = false;
				bayInput.classList.remove("disabled");

				pinGenBtn.disabled = false;
				pinGenBtn.classList.remove("disabled");

				ritmBox.disabled = false;
				ritmBox.classList.remove("disabled");
				ritmInput.disabled = false;
				ritmInput.classList.remove("disabled");

				copyBayOutput.disabled = false;
				copyBayOutput.classList.remove("disabled");
				
				copyButton4.disabled=false;
				copyButton4.classList.remove("disabled");
				
				pinInput.disabled=false;
				pinInput.classList.remove("disabled");	


		}
		
	}
	
	function resetName()
	{
		document.getElementById('nameInput').value = "";
		updateOutput();
	}
	
	function resetRITM()
	{
		document.getElementById('ritmInput').value = "";
	}
	
	//LISTNERS
	followUpBtn.addEventListener("change", followUpBtnChange);
	followUpBtnCollection.addEventListener("change", followUpBtnCollectionChange);
	followUpBtnDecom.addEventListener("change", followUpBtnDecomChange);
	followUpBtnLoan.addEventListener("change", followUpBtnLoanChange);
	
	accessoryBtn.addEventListener("change", accessoryBtnChange);
	lockerBtn.addEventListener("change", lockerBtnChange);
	staffBtn.addEventListener("change", staffBtnChange);
	
	
	function pinBayFields(enable)
	{
		const elements = [nameSettings, clearAllBtn,nameInput,pinCopyBtn,pinGenBtn,pinInput,bayInput,copyBayOutput,ritmInput];
                                                                    
		elements.forEach(element => {
			element.disabled = !enable; // Set disabled based on the enable parameter
			if (enable)
			{
				element.classList.remove("disabled"); // Remove disabled class when enabling
				element.title = ""; // Clear tooltip message when enabled
			} 
			else 
			{
				element.classList.add("disabled"); // Add disabled class when disabling
				element.title = "User is collecting from Techbar staff"; // Set tooltip message when disabled
			}
		});
	}
	
	function followUpBtnCollectionChange()
	{
		
	
	    if (followUpBtnCollection.checked)
		{
			const width = window.innerWidth;
			const bayBtns = document.getElementById("bayOutputFields");
			
			if (width >800)
			{	
				bayBtns.style.display = "block";
				outputCollection.style.display = 'block';
			}
			if (width <=800)
			{
				bayBtns.style.display = "block";
				outputCollection.style.display = 'none';
			}

			followUpBoxCollection.style.borderColor = "green"; // Change box border color
			followUpBoxDecom.style.borderColor = "";
			followUpBoxLoan.style.borderColor = "";	
			document.getElementById("bayEmailLabel").textContent = "Email";
			
			firstLine = `Just a friendly reminder that your device is now ready to collect from RMIT Techbar @`;
			secondLine = `\n\nYour device has been assigned to our PC locker tower. \n\nPlease refer to previous emails to access your PIN and Bay number, or speak to Techbar staff for assistance.`;
			finalLine = `\n\nIf you require any assistance with setting up your new device, please approach our staff at the Techbar who are available to help.`;
			updateOutput();
			
			lockerBtn.style.display = "block";
			lockerBox.style.display = "block";
			staffBtn.style.display = "block";			
			staffBox.style.display = "block";
			
			if (!staffBtn.checked && !lockerBtn.checked)
			{
				lockerBtn.checked = true;
				lockerBox.style.borderColor = "green";
				staffBtn.checked = false;
				staffBtn.style.borderColor = "";
			}
			
			
			
		}

		
		followUpBtnDecom.checked = false;
		followUpBtnLoan.checked = false;
		lockerBtn.disabled = false;
		staffBtn.disabled = false;
		
		
		
	}
	
	function followUpBtnDecomChange()
	{
		followUpBtnCollection.checked = false;
		followUpBtnLoan.checked = false;
		
		
		
		if (followUpBtnDecom.checked)
		{
		
			const width = window.innerWidth;
			const bayBtns = document.getElementById("bayOutputFields");
			
			if (width >800)
			{	
				bayBtns.style.display = "block";
				outputCollection.style.display = 'block';
			}
			if (width <=800)
			{
				bayBtns.style.display = "block";
				outputCollection.style.display = 'none';
			}
			
			
			
			staffBtn.checked = false;
			
			document.getElementById("bayEmailLabel").textContent = "Email";
			
			staffBox.style.borderColor = ""; 
			lockerBox.style.borderColor = ""; 
			
			followUpBoxCollection.style.borderColor = ""; // Change box border color
			followUpBoxDecom.style.borderColor = "green";
			followUpBoxLoan.style.borderColor = "";	
			
			firstLine = `Just a friendly reminder to please return your old device to the RMIT Techbar @`;
			secondLine = '';
			thirdLine = '';
			fourthLine = '';
			finalLine = '';
			updateOutput();
			
			lockerBtn.style.display = "none";
			staffBtn.style.display = "none";
			lockerBox.style.display = "none";
			staffBox.style.display = "none";
			
			//remove lines
			verticalLines.forEach(function(line)
						{
							line.remove(); 
						});
			
			
		}
		
		
		
	}
	
	function followUpBtnLoanChange()
	{
		followUpBtnDecom.checked = false;
		followUpBtnCollection.checked = false;
		staffBtn.checked = false;

	
		
		if (followUpBtnLoan.checked)
		{
			const width = window.innerWidth;
			const bayBtns = document.getElementById("bayOutputFields");
			
			if (width >800)
			{	
				bayBtns.style.display = "block";
				outputCollection.style.display = 'block';
			}
			if (width <=800)
			{
				bayBtns.style.display = "block";
				outputCollection.style.display = 'none';
			}
			
			followUpBoxCollection.style.borderColor = ""; // Change box border color
			followUpBoxDecom.style.borderColor = "";
			followUpBoxLoan.style.borderColor = "green";	
			
			document.getElementById("bayEmailLabel").textContent = "Email";
			
			lockerBtn.style.display = "none";
			staffBtn.style.display = "none";
			lockerBox.style.display = "none";
			staffBox.style.display = "none";
			
			staffBox.style.borderColor = ""; 
			lockerBox.style.borderColor = ""; 
			
			firstLine = `Just a friendly reminder to please return the loan device provided to the RMIT Techbar @`;
			secondLine = '';
			thirdLine = '';
			fourthLine = '';
			finalLine = '';
			
			updateOutput();
			
			//remove lines
			verticalLines.forEach(function(line)
						{
							line.remove(); 
						});
						
			}
		
	}
	
	function followUpBtnChange() {

		const outputPinField = document.getElementById('outputPIN');
		const pinOutputFields = document.getElementById('pinOutputFields');
		
		
		
    // Only execute if followUpBtn is not disabled
    if (!followUpBtn.disabled) {
        if (followUpBtn.checked) {
		
            const bayBtns = document.getElementById("bayOutputFields");
			bayBtns.style.display = "none";
            firstLine = ``;
			secondLine = `\n\nYour device has been assigned to our PC locker tower. \n\nPlease refer to previous emails to access your PIN and Bay number, or speak to Techbar staff for assistance.`;
			thirdLine = ``;
			fourthLine = ``;
			
			document.getElementById("bayEmailLabel").textContent = "Email";
			
			followUpBox.style.borderColor = "green"; // Reset box border color
			accessoryBtn.disabled = true;
			accessoryBtn.classList.add("disabled");
			accessoryBtn.checked = false;
			accessoryBox.style.borderColor = ""; // Reset accessory box border color
			
			//show loan, decom and collection buttons
			followUpBoxCollection.style.display = 'flex'; 
			followUpBoxDecom.style.display = 'flex';
			followUpBoxLoan.style.display = 'flex';

			//hide third row and PIN collection output and buttons
			thirdRow.style.display = "none";
			outputPinField.style.display = 'none';
			pinOutputFields.style.display = 'none';
			
			lockerBtn.style.display = "block";
			staffBtn.style.display = "block";
			lockerBox.style.display = "block";
			staffBox.style.display = "block";
			
			outputCollection.style.display = 'none';
		
        } 
		
		
		
		if (!followUpBtn.checked) {
			
			const width = window.innerWidth;
            followUpBox.style.borderColor = ""; // Reset box border color
            firstLine = `Your computer is now ready to collect from RMIT Techbar @`;
			secondLine = `\n\nYour device has been assigned to a PC Locker tower, you will receive a separate email from RMIT Device Collection with a Pin number. \n\nYour Bay number is: `;
			thirdLine = `\n\nYou will be required to collect your device during university operation hours within 5 business days.`;
			
			accessoryBtn.disabled = false;
			accessoryBtn.classList.remove("disabled");
			
			document.getElementById("bayEmailLabel").textContent = "Bay Email";
			
			//hide loan, decom and collection buttons
			followUpBoxCollection.style.display = 'none'; 
			followUpBoxDecom.style.display = 'none';
			followUpBoxLoan.style.display = 'none';
			
			//uncheck follow up options and reset borders
			followUpBtnCollection.checked = false;
			followUpBtnDecom.checked = false;
			followUpBtnLoan.checked = false;
			
			followUpBoxCollection.style.borderColor = "";
			followUpBoxDecom.style.borderColor = "";
			followUpBoxLoan.style.borderColor = "";
			
			//lockerBtn.checked = true;
			
			
			//show third row and PIN collection output and buttons
			thirdRow.style.display = "block";
			
			lockerBtn.style.display = "block";
			staffBtn.style.display = "block";
			lockerBox.style.display = "block";
			clearAllBtn.disabled= false;
			clearAllBtn.classList.remove("disabled");
			
			staffBox.style.display = "block";
			//outputCollection.style.display = 'block';
			
			if (!staffBtn.checked && !lockerBtn.checked)
			{
				lockerBtn.checked = true;
				lockerBox.style.borderColor = "";
			
				
			}
			
			
			if (width>=800)
			{
					
					pinOutputFields.style.display = 'block';
					outputPinField.style.display = 'block';
					outputCollection.style.display = 'block';
					
			}
				
			
			if (staffBtn.checked)
			{
				const bayBtns = document.getElementById("bayOutputFields");
				bayBtns.style.display = "block";
				thirdRow.style.display = "none";
				document.getElementById("bayEmailLabel").textContent = "Email";
				pinOutputFields.style.display = 'none';
				staffBtn.checked = false;
				staffBox.style.borderColor = "";
				lockerBtn.checked = true;
				lockerBox.style.borderColor = "green";
				
				
			}
			
			else
			{
				const bayBtns = document.getElementById("bayOutputFields");
				bayBtns.style.display = "block";	
				
				pinOutputFields.style.display = 'block';
				staffBtn.checked = false;
				lockerBox.style.borderColor = "green";
				
			}
			
		}

        // Update the output field
        updateOutput();
		}
	}
	
	<!-- function returnBtnChange() { -->
    <!-- // Only execute if followUpBtn is not disabled -->
    <!-- if (!returnBtn.disabled) { -->
        <!-- if (returnBtn.checked) { -->
           <!-- //returnBox.style.borderColor = "green"; // Change box border color -->
            
        <!-- } else { -->
            <!-- //returnBox.style.borderColor = ""; // Reset border color -->
            
        <!-- } -->

        <!-- // Update the output field -->
        <!-- updateOutput(); -->
		<!-- } -->
	<!-- } -->
	
		
	
	function lockerBtnChange()
	{
		if (lockerBtn.checked)
		{
			lockerBox.style.borderColor = "green"; // Change box border color
			staffBox.style.borderColor = ""; // Reset border color	
			
			openingHoursBox.style.display = "none"; //hide opening hours
			updateOutput();	
			pinBayFields(true);
			
			document.getElementById("bayEmailLabel").textContent = "Bay Email";

			document.getElementsByName('nameOption')[0].checked = true;
	
			thirdRow.style.display = "block";
			pinOutputFields.style.display = "block";
			
			if (followUpBtn.checked)	
			{
				followUpBtnChange();
				followUpBtnCollectionChange();
				
				disableBayandPin();
			}
			
			else
			{
				secondLine = `\n\nYour device has been assigned to a PC Locker tower, you will receive a separate email from RMIT Device Collection with a Pin number. \n\nYour Bay number is: `;
			}
			
			updateOutput();
			
			
			
		} 
		else 
		{
			
		}
	}

	function accessoryBtnChange()
	{
		if (accessoryBtn.checked)
		{
			if (followUpBtn.checked)
			{
				firstLine = `Just a friendly reminder that your device is now ready to collect from RMIT Techbar @`;
				
			}
			
			else
			{
				firstLine = `Your accessory is now ready to collect from RMIT Techbar @`;
			}
			

			// Disable return and brand new buttons when accessory is checked
			//returnCheckbox.checked = false; 
			//returnCheckbox.disabled = true; 
			//returnBox.disabled = true;
			//returnBox.classList.add("disabled");
			//returnBox.title = "Uncheck accessory";

			accessoryBox.style.borderColor = "green"; // Change accessory box border color
			//returnBox.style.borderColor = ""; // Reset return box border color

			
			
		} 
		
		else 
		{
			firstLine = `Your computer is now ready to collect from RMIT Techbar @`;

			// Enable return and brand new buttons when accessory is unchecked
			<!-- returnCheckbox.disabled = false; -->
			<!-- returnCheckbox.checked = true; -->
			<!-- returnCheckbox.classList.remove("disabled"); -->
			<!-- returnBox.classList.remove("disabled"); -->
			<!-- returnBox.style.borderColor = "Green"; -->

			accessoryBox.style.borderColor = ""; // Reset accessory box border color

			// Enable brand new button and box
			

			// Manually trigger followUpBtnChange to update the output immediately
			followUpBtnChange();
		}

		
		updateOutput();
	}
	
	
	function staffBtnChange()
	{
		var location = ``;
		var outputNameCollection = ``;
		const nameOptions =  document.getElementsByName("nameOption");
		var name = document.getElementById('nameInput').value;
		const dropdown = document.getElementById('nameDropdown');
		
		const locationDropdown = document.getElementById("locationSelect");
		const selectedLocation = locationDropdown.value; // Get the selected value
		
		
		
		
		if (staffBtn.checked)
		{
			staffBox.style.borderColor = "green"; // Change box border color
			lockerBox.style.borderColor = ""; // Reset border color	
			document.getElementById("outputPIN").innerHTML = ""; //remove PIN output field
			pinBayFields(false); //disable PIN fields
			resetBay(); //remove PIN from field


			document.getElementById("bayEmailLabel").textContent = "Email";
			
			thirdRow.style.display = "none";
			pinOutputFields.style.display = "none";
			
			dropdown.style.display = 'none'; // Close the dropdown

			document.getElementsByName('nameOption')[3].checked = true; //check "none" option from name setting dropdown
			updateOutput();
			
			
		} 
	
	}
	
	
	function emailPin()
	{
		const pinOutput = document.getElementById('outputPIN').textContent;
		const subject = `RMIT Device Collection PIN`;
		const body = `${name || ''}\n\n${pinOutput}\n\n`;
		const button = document.getElementById("emailPin");

		// Create the mailto link
		const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

		
		if (pinInput.value === "" && lockerBtn.checked && button.id === "emailPin")
		{
			button.innerHTML = '<i class="fa-solid fa-triangle-exclamation"></i>'; // Change icon 
			
			// Reset the button icon after 3 seconds
			setTimeout(() => {
				button.innerHTML = '<i class="fa-solid fa-envelope" title="Email to user"></i>'; // Reset icon
			}, 2000);
			
			//change empty field (PIN) red
			// Store the original border color
			const originalBorder = pinBox.style.border;

			// Change the border color to red
			pinBox.style.border = '2px solid red';

			// After 1 second, restore the original border color
			setTimeout(() => 
			{
				pinBox.style.border = originalBorder; // Restore original border color
			}, 2000); // 1 second
		}
		
		else
		{		
			// Open the default email client
			window.location.href = mailtoLink;
		
			button.innerHTML = '<i class="fas fa-check icon"></i>'; // Change icon 
			
			// Reset the button icon after 3 seconds
			setTimeout(() => {
				button.innerHTML = '<i class="fa-solid fa-envelope" title="Email to user"</i>'; // Reset to copy icon
			}, 1500);
		}
	}
	
	
	


	function collapse()
	{
		firstRow.style.display = "none";
		secondRow.style.display = "none";
		expandBtn.style.display = "block";
		
		if(staffBtn.checked)
		{
			hiddenRow.style.display = "block";
		}
	}
	
	function expand()
	{
		firstRow.style.display = "block";
		secondRow.style.display = "block";
		expandBtn.style.display = "none";
		
		if(staffBtn.checked)
		{
			hiddenRow.style.display = "none";
			
		}
	}


	function nameSettigs() 
	{
		const dropdown = document.getElementById('nameDropdown');
		dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
	}
	
	function followUpOptions() 
	{
	
	
		<!-- const dropdown = document.getElementById('followUpDropdown'); -->
		<!-- dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block'; -->
	}
	
	function copyPin() 
	{
		// Get the hidden input element
		const pinInput = document.getElementById("actualPin");

		// Get the value of the hidden input
		const pinValue = pinInput.value;

		// Change the button icon to a check mark
		const button = document.getElementById("copyButton4");
		button.innerHTML = '<i class="fas fa-check icon"></i>'; // Change icon to check mark

		// Reset the button icon after 1.5 seconds
		setTimeout(() => {
			button.innerHTML = '<i class="fas fa-copy icon"></i>'; // Reset to copy icon
		}, 1500);

		// Use the Clipboard API to copy the value directly
		navigator.clipboard.writeText(pinValue)
			.then(() => {
				console.log('PIN copied to clipboard!');
			})
			.catch(err => {
				console.error("Error copying text: ", err);
			});
	}

	
	document.addEventListener("DOMContentLoaded", () => {
    checkLocation(); // Initial check
	});
	
	
	
	
//END COLLECTION SCRIPTS
		
//ADOBE SCRIPTS
	<!-- open adobe link button -->
	function openAdobeLink()
	{
		const link = document.getElementById('linkInput').value;
		window.open(link, '_blank'); // Open link in a new tab
	}
	
	<!-- copy adobe button -->
	function copyAdobeLink()
	{
		const linkInput = document.getElementById('linkInput');
   
		// Create a temporary textarea to copy the text
		const tempTextarea = document.createElement('textarea');
		tempTextarea.value = linkInput.value;
		document.body.appendChild(tempTextarea);
		
		tempTextarea.select();
		document.execCommand('copy');
		
		document.body.removeChild(tempTextarea);
		
		//change icon
		const button = document.getElementById("copyAdobeForm");
		button.innerHTML = '<i class="fas fa-check icon"></i>'; // Change icon to check mark

		// Reset the button icon after 3 seconds
		setTimeout(() => {
			button.innerHTML = '<i class="fas fa-copy icon"></i>'; // Reset to copy icon
			}, 3000);
	}
	
	<!-- reset adobe form -->
	function resetAdobeForm()
	{
		document.getElementById("adobeEmailInput").value = "";
		document.getElementById("adobeNameInput").value = "";
	}
	
	<!-- email adobe button -->
	function emailAdobe()
	{
		const email = document.getElementById('adobeEmailInput').value;
		const name = document.getElementById('adobeNameInput').value;
		const link = document.getElementById('linkInput').value;

		const subject = `Adobe Form `; // Use name or default to 'User'
		const body = `Hello,${name || ''}\n\nPlease fill out the followig form for Adobe access, mentioning the software you need access to. \n\nCopy and paste the link below into your web browser:\n\n${link}\n\nBest regards,\nRMIT Techbar team. \n\nPlease do not reply to this email`;

		// Create the mailto link
		const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
		
		// Open the default email client
		window.location.href = mailtoLink;
	}

	function teamsAdobe() 
	{
		const email = document.getElementById('adobeEmailInput').value; // You can use this for user identification if needed
		const name = document.getElementById('adobeNameInput').value;
		const link = document.getElementById('linkInput').value;

		const message = `Hi ${name || ''},\n\nPlease fill out the form for Adobe access, mentioning the software you need access to. \n\nCopy and paste the link below into your web browser:\n\n${link}\n\nBest regards,\nRMIT Techbar team.`;

		// Create the Teams deep link
		const teamsLink = `https://teams.microsoft.com/l/chat/0/0?users=${email}&message=${encodeURIComponent(message)}`;

		// Open the Microsoft Teams client or web app
		window.open(teamsLink, '_blank');
	}

//END ADOBE SCRIPTS



//START BAY NAME SCRIPTS

	function updateBayNameOutput() 
	{

		const bayNumber = document.getElementById('bayInput').value;
		const ritm = document.getElementById('ritmInput').value;
		const endUser = document.getElementById('nameInput').value;
		var finalBayOutput = "";
		const fiveBusinessDaysLater = addBusinessDays(new Date(), 5);
		const formattedDate = fiveBusinessDaysLater.toLocaleDateString('en-GB', {
		  day: '2-digit',     // Ensure the day is two digits
		  month: '2-digit',   // Ensure the month is two digits
		  year: '2-digit'     // Ensure the year is two digits
		});
		const button = document.getElementById("copyBayOutput");


		//add 5 business days to field
		function addBusinessDays(startDate, days) 
		{
			let count = 0;
			const currentDate = new Date(startDate);

			while (count < days) {
				currentDate.setDate(currentDate.getDate() + 1);
				// Check if the current date is a weekday (Monday to Friday)
				if (currentDate.getDay() !== 0 && currentDate.getDay() !== 6) {
					count++;
				}
			}
			return currentDate;
		}
		
		if (nameInput.value ==="")
		{
			finalBayOutput = `Bay ${bayNumber}: ${ritm} - remove ${formattedDate}.`;
		}
		
		else
		{
			finalBayOutput = `Bay ${bayNumber}: ${ritm} - ${endUser} - remove ${formattedDate}.`;
		}
		
	
		if (bayInput.value === "" && lockerBtn.checked) 
		{
			// Change the button icon when conditions are met
			button.innerHTML = '<i class="fa-solid fa-triangle-exclamation"></i>'; // Change icon
			
			// Reset the button icon after 1.5 seconds
			setTimeout(() => {
				button.innerHTML = '<i class="fa-solid fa-file-export" title="Copy bay #, RITM, name and date(+5 days) for locker bay field"></i>'; // Reset to copy icon
				
			}, 1500);
			
			// Change the border color of bayBox to red if the conditions are met
			const bayBox = document.getElementById('bayBox'); 
			const originalBorder = bayBox.style.border; // Store the original border color
			
			// Change the border color to red
			bayBox.style.border = '2px solid red';

			// After 1 second, restore the original border color
			setTimeout(() => {
				bayBox.style.border = originalBorder; // Restore original border color
			}, 1500); // 1.5 seconds
		}
		
		if (ritmInput.value === "" && lockerBtn.checked) 
		{
			// Change the button icon when conditions are met
			button.innerHTML = '<i class="fa-solid fa-triangle-exclamation"></i>'; // Change icon
			
			// Reset the button icon after 1.5 seconds
			setTimeout(() => {
				button.innerHTML = '<i class="fa-solid fa-file-export" title="Copy bay #, RITM, name and date(+5 days) for locker bay field"></i>'; // Reset to copy icon
				
			}, 1500);
			
			// Change the border color of bayBox to red if the conditions are met
			const ritmBox = document.getElementById('ritmBox'); 
			const originalBorder = ritmBox.style.border; // Store the original border color
			
			// Change the border color to red
			ritmBox.style.border = '2px solid red';

			// After 1 second, restore the original border color
			setTimeout(() => {
				ritmBox.style.border = originalBorder; // Restore original border color
			}, 1500); // 1.5 seconds
		}
		
		else
		{
			//change icon
			button.innerHTML = '<i class="fas fa-check icon"></i>'; // Change icon to check mark

			// Reset the button icon after 3 seconds
			setTimeout(() => {
				button.innerHTML = '<i class="fa-solid fa-file-export"></i>'; // Reset to copy icon
				}, 1000);
			
			
			// Copy to clipboard
			navigator.clipboard.writeText(finalBayOutput).then(() => {
				console.log('Copied to clipboard successfully!');
			}).catch(err => {
				console.error('Could not copy text: ', err);
			});
		}
		
		
		
	}	
	
	//resets the form
	function resetBayNameForm()
	{
		document.getElementById("bayNumber").value = "";
		document.getElementById("ritmInput").value = "";
		document.getElementById("repairFaultsInput").value = "";
		document.getElementById("endUser").value = "";
		document.getElementById('bayNameOutput').innerText = "";
	}
	
	

//END BAY NAME SCRIPTS
//FUTURE SCRIPTS
//FUTURE SCRIPTS
</script>
</body>
</html>
